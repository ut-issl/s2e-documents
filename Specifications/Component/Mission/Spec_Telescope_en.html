<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Telescope - S2E documents</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../Overview.html">Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">General Information</li><li class="chapter-item expanded "><a href="../../../General/CodingConvention.html"><strong aria-hidden="true">1.</strong> Coding Convention</a></li><li class="chapter-item expanded "><a href="../../../General/DocumentFormat.html"><strong aria-hidden="true">2.</strong> Format of Documents</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Setup Environment</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../General/HowToCompileWithVisualStudio.html"><strong aria-hidden="true">3.1.</strong> How to compile with Visual Studio</a></li><li class="chapter-item expanded "><a href="../../../General/HowToCompileWithUbuntuInDocker.html"><strong aria-hidden="true">3.2.</strong> How to compile with Ubuntu in Docker</a></li><li class="chapter-item expanded "><a href="../../../General/HowToCompileWith_OSX.html"><strong aria-hidden="true">3.3.</strong> How to compile with OSX Environment</a></li><li class="chapter-item expanded "><a href="../../../General/HowToDownloadNRLMSISE00library.html"><strong aria-hidden="true">3.4.</strong> How to download and make NRLMSISE00 Library</a></li><li class="chapter-item expanded "><a href="../../../General/HowToDwnloadCSPCElibrary.html"><strong aria-hidden="true">3.5.</strong> How to download CSPICE Library</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Tutorials</li><li class="chapter-item expanded "><a href="../../../Tutorials/GettingStarted.html"><strong aria-hidden="true">4.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToMakeNewSimulationScenario.html"><strong aria-hidden="true">5.</strong> How To Make New Simulation Scenario</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToAddComponents.html"><strong aria-hidden="true">6.</strong> How To Add Components</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToMakeNewComponents.html"><strong aria-hidden="true">7.</strong> How To Make New Components</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToUseMonteCarloSimulation.html"><strong aria-hidden="true">8.</strong> How To Use Monte Carlo Simulation</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToAddControlAlgorithms.html"><strong aria-hidden="true">9.</strong> How To Add Control Algorithms</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToIntegrateC2A.html"><strong aria-hidden="true">10.</strong> How To Integrate C2A</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToPerformUartHilsTest.html"><strong aria-hidden="true">11.</strong> How To Perform UART HILS Test</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToPerformI2cHilsTest.html"><strong aria-hidden="true">12.</strong> How To Perform I2C HILS Test</a></li><li class="chapter-item expanded "><a href="../../../Tutorials/HowToSimulateMultipleSatellites.html"><strong aria-hidden="true">13.</strong> How to simulate multiple satellites</a></li><li class="chapter-item expanded affix "><li class="part-title">Specifications</li><li class="chapter-item expanded "><a href="../../../Specifications/OverallStructure/OverallStructure.html"><strong aria-hidden="true">14.</strong> Overall Structure</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> Component</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">15.1.</strong> Abstract</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Component/Abstract/Spec_ComponentBase.html"><strong aria-hidden="true">15.1.1.</strong> Component Base</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Component/Abstract/Spec_ObcCommunicationBase.html"><strong aria-hidden="true">15.1.2.</strong> OBC Communication Base</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Component/Abstract/Spec_SensorBase.html"><strong aria-hidden="true">15.1.3.</strong> Sensor Base</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.2.</strong> AOCS</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Component/AOCS/Spec_STT.html"><strong aria-hidden="true">15.2.1.</strong> STT</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Component/AOCS/Spec_RWJitter.html"><strong aria-hidden="true">15.2.2.</strong> RW Jitter</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.3.</strong> CDH</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.4.</strong> Logic</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.5.</strong> Mission</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Component/Mission/Spec_Telescope_en.html" class="active"><strong aria-hidden="true">15.5.1.</strong> Telescope</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.6.</strong> Power</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Component/Power/Spec_PCU.html"><strong aria-hidden="true">15.6.1.</strong> PCU</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.7.</strong> Propulsion</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Component/Propulsion/Spec_SimpleThruster.html"><strong aria-hidden="true">15.7.1.</strong> SimpleThruster</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.8.</strong> Thermal</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">16.</strong> Disturbance</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_GeoPotential.html"><strong aria-hidden="true">16.1.</strong> GeoPotential</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_GGTorque.html"><strong aria-hidden="true">16.2.</strong> Gravity Gradient Torque</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_MagDisturbance.html"><strong aria-hidden="true">16.3.</strong> Magnetic Disturbance Torque</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_SurfaceForce.html"><strong aria-hidden="true">16.4.</strong> Surface force</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_SurfaceForce_AirDrag.html"><strong aria-hidden="true">16.4.1.</strong> Air Drag</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_SurfaceForce_SolarRadiation.html"><strong aria-hidden="true">16.4.2.</strong> Solar Radiation Pressure</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Specifications/Disturbance/Spec_ThirdBodyGravity.html"><strong aria-hidden="true">16.5.</strong> Third Body Gravity</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Dynamics</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">17.1.</strong> Attitute</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_AttitudeDynamics.html"><strong aria-hidden="true">17.1.1.</strong> Attitude Dynamics</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_ControlledAttitude.html"><strong aria-hidden="true">17.1.2.</strong> Controlled Attitude</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_Orbit.html"><strong aria-hidden="true">17.2.</strong> Orbit</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_KeplerOrbit.html"><strong aria-hidden="true">17.2.1.</strong> Kepler Orbit Propagation</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_Sgp4.html"><strong aria-hidden="true">17.2.2.</strong> SGP4 Orbit Propagation</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_Rk4Orbit.html"><strong aria-hidden="true">17.2.3.</strong> RK4 Orbit Propagation</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_EnckeMethod.html"><strong aria-hidden="true">17.2.4.</strong> Orbit Propagation with Encke's Method</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Dynamics/Spec_RelativeOrbit.html"><strong aria-hidden="true">17.2.5.</strong> Relative Orbit</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.3.</strong> Thermal</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Environment</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Environment/Spec_SRPEnvironment.html"><strong aria-hidden="true">18.1.</strong> SRP Environment</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Environment/Spec_Atmosphere.html"><strong aria-hidden="true">18.2.</strong> Atmosphere</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Environment/Spec_MagEnvironment.html"><strong aria-hidden="true">18.3.</strong> Magnetic Environment</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Environment/Spec_HipparcosCatalogue_en.html"><strong aria-hidden="true">18.4.</strong> Hipparcos Catalogue</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Environment/Spec_GnssSatellites_en.html"><strong aria-hidden="true">18.5.</strong> GNSS Satellites</a></li><li class="chapter-item expanded "><a href="../../../Specifications/Environment/Spec_CelestialRotation.html"><strong aria-hidden="true">18.6.</strong> Celestial Rotation</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> Interface</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Interface/Spec_PowerPort.html"><strong aria-hidden="true">19.1.</strong> Power Port</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.</strong> Library</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.</strong> Simulation</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Specifications/Simulation/Spec_MonteCarloSimulation.html"><strong aria-hidden="true">21.1.</strong> Monte Carlo Simulation</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">S2E documents</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="specification-for-telescope"><a class="header" href="#specification-for-telescope">Specification for Telescope</a></h1>
<h2 id="1--overview"><a class="header" href="#1--overview">1.  Overview</a></h2>
<ul>
<li>This class simulates a telescope.</li>
<li>This class uses the position information of celestial bodies and returns the following data:
<ul>
<li>Flags that show whether the bright celestial bodies(the Earth, the Moon, and the Sun) are in the forbidden angle of the telescope</li>
<li>Positions of the celestial bodies on the image sensor</li>
<li>Positions of stars on the image sensor</li>
</ul>
</li>
</ul>
<h3 id="1-functions"><a class="header" href="#1-functions">1. functions</a></h3>
<ul>
<li><code>MainRoutine</code> runs the following three functions:
<ul>
<li><code>JudgeForbiddenAngle</code>
<ul>
<li>Function to judge whether the celestial body is in the forbidden angle.</li>
</ul>
</li>
<li><code>Observe</code>
<ul>
<li>Function to 
<ul>
<li>judge whether the celestial body(provided by <code>CelesInfo</code>) is in the field of view.</li>
<li>output position of its image on the image sensor, if it is in the field of view.</li>
</ul>
</li>
</ul>
</li>
<li><code>ObserveStars</code>
<ul>
<li>Function to output some HIP IDs of the brightest stars in the field of view, using <code>HipparcosCatalogue</code>.</li>
<li>Specify how many stars this function outputs in <code>telescope.ini</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="2-files"><a class="header" href="#2-files">2. files</a></h3>
<ul>
<li><code>telescope.cpp</code> , <code>telescope.hpp</code>
<ul>
<li>Definitions and declarations of the class</li>
</ul>
</li>
<li><code>hipparcos_catalogue.cpp</code> , <code>hipparcos_catalogue.hpp</code>
<ul>
<li>Definitions and declarations of the class to read Hipparcos catalogue.</li>
</ul>
</li>
</ul>
<h3 id="3-how-to-use"><a class="header" href="#3-how-to-use">3. how to use</a></h3>
<ul>
<li>Set the parameters in <code>telescope.ini</code></li>
<li>Create instance by using initialization function <code>InitTelescope</code>.
<ul>
<li>Each telescope is numbered as &quot;Telescope1,…&quot;</li>
</ul>
</li>
<li>To use <code>HipparcosCatalogue</code> data, <code>hip_main.csv</code> is necessary. <code>s2e-core/scripts/Common/download_HIPcatalogue.sh</code> is the script to download it. Run the following code using Git bash in <code>s2e-core/scripts/</code>:
<pre><code>bash download_HIPcatalogue.sh 
</code></pre>
</li>
</ul>
<h2 id="2-explanation-of-algorithm"><a class="header" href="#2-explanation-of-algorithm">2. Explanation of Algorithm</a></h2>
<h3 id="1-judgeforbiddenangle"><a class="header" href="#1-judgeforbiddenangle">1. <code>JudgeForbiddenAngle</code></a></h3>
<h4 id="1-overview"><a class="header" href="#1-overview">1. overview</a></h4>
<ul>
<li>Function to judge whether a celestial body is in the forbidden angle.</li>
</ul>
<h4 id="2-input-and-output"><a class="header" href="#2-input-and-output">2. input and output</a></h4>
<ul>
<li>input
<ul>
<li>The position vector of the celestial body in the body-fixed coordinate.
<ul>
<li>This position vector is provided by <code>CelestialInformation</code>.</li>
</ul>
</li>
<li>The forbidden angle about the celestial body
<ul>
<li>Specify the forbidden angle in <code>telescope.ini</code>.</li>
</ul>
</li>
</ul>
</li>
<li>output
<ul>
<li>true: The celestial body is in forbidden angle</li>
<li>false: The celestial body is  not in forbidden angle</li>
</ul>
</li>
</ul>
<h4 id="3-process-to-judge"><a class="header" href="#3-process-to-judge">3. process to judge</a></h4>
<ul>
<li>The judging process is calculated in the telescope's component coordinate. $q_{b2c}$ is the quaternion to convert from the body coordinate(B) to the component coordinate(C). Specify $q_{b2c}$ in <code>telescope.ini</code>. The X-axis of the component coordinate is defined as the line of sight of the telescope.</li>
</ul>
<h3 id="2-observe"><a class="header" href="#2-observe">2. <code>Observe</code></a></h3>
<h4 id="1-overview-1"><a class="header" href="#1-overview-1">1. overview</a></h4>
<ul>
<li>This function judges whether the celestial bodies(provided by <code>CelestialInformation</code>) are in the field of view and outputs the position of them on the image sensor if they are in the field of view</li>
<li>If they are not in the field of view, this function outputs $(-1,-1)$.</li>
</ul>
<h4 id="2-input-and-output-1"><a class="header" href="#2-input-and-output-1">2. input and output</a></h4>
<ul>
<li>input
<ul>
<li>The reference to the position of the celestial body on the image sensor</li>
<li>The position vector of the celestial body in the body-fixed coordinate
<ul>
<li><code>CelestialInformation</code> provides the position vector.</li>
</ul>
</li>
</ul>
</li>
<li>output
<ul>
<li>(void)
<ul>
<li>This function rewrites the &quot;reference to the celestial body's position on the image sensor&quot; given as the input.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="3-algorithm"><a class="header" href="#3-algorithm">3. algorithm</a></h4>
<h5 id="1-calculate-process-to-judge-whether-the-celestial-body-is-in-the-field-of-view"><a class="header" href="#1-calculate-process-to-judge-whether-the-celestial-body-is-in-the-field-of-view">1. Calculate process to judge whether the celestial body is in the field of view</a></h5>
<ul>
<li>A 2D coordinate on the image sensor is defined to handle the position on the image sensor. The definition is as follows:
<ul>
<li>The X-axis of the image sensor coordinate corresponds with the Z-axis of the component coordinate.</li>
<li>The Y-axis of the image sensor coordinate corresponds with the Y-axis of the component coordinate.</li>
</ul>
</li>
<li>Then, the inclination angle from the X-axis of the celestial body's direction in the XZ plane of the component coordinate is calculated using $(x_c, y_c, z_c)$ as follows:</li>
</ul>
<p>\[
tan^{-1}⁡\frac{z_c}{x_c}
\]</p>
<ul>
<li>In the same way, the inclination angle from the X-axis of the celestial body's direction in the XY plane of the component coordinate is calculated as follows:</li>
</ul>
<p>\[
tan^{-1}⁡\frac{y_c}{x_c}
\]</p>
<ul>
<li>They are written as <code>arg_x</code> and <code>arg_y</code> in the code. In this manual, $\theta_x$ and $\theta_y$ are used for them. If $\theta_x$ is within FOV_x and $\theta_y$ is within FOV_y, the celestial body is judged to be in the field of view.</li>
</ul>
<div align="center">
<figure id="coordinate">
<img src="./figs/coordinate.JPG" width=400 alt="The relationship between the component coordinate(C) and the sensor coordinate(imgsensor)">
<figcaption>Fig. 1. The relationship between the component coordinate(C) and the sensor coordinate(imgsensor)</figcaption>
</figure>
</div>
<h5 id="2-calculate-process-for-calculating-the-position-of-the-image"><a class="header" href="#2-calculate-process-for-calculating-the-position-of-the-image">2. Calculate process for calculating the position of the image</a></h5>
<ul>
<li>The origin of the sensor coordinate is the corner of the image sensor, so $x_{imgsensor}$ and $y_{imgsensor}$ have positive values. The unit of them is pixel(pix). In this manual, $N_x$ and $N_y$ are used for the total number of pixels along x, y axes of the sensor coordinate (They are <code>x_num_of_pix</code> and <code>y_num_of_pix</code> in the code). In the same way, <code>X</code> and <code>Y</code> are used for the position of the celestial body on the image sensor (They are <code>pos_imgsensor[0]</code> and <code>pos_imgsensor[1]</code>). Then, <code>X</code> and <code>Y</code> are calculated as follows:
\[
X=\frac{N_x}{2}\times\frac{\tan(\theta_x)}{\tan(FOV_x)}+\frac{N_x}{2}
\]
\[
Y=\frac{N_y}{2}\times\frac{\tan(\theta_y)}{\tan(FOV_y)}+\frac{N_y}{2}
\]</li>
</ul>
<p>If the celestial body is not in the field of view, the output is $X=Y=-1$.</p>
<h3 id="3-observestars"><a class="header" href="#3-observestars">3. <code>ObserveStars</code></a></h3>
<h4 id="1-overview-2"><a class="header" href="#1-overview-2">1. overview</a></h4>
<ul>
<li>Function to output some HIP IDs of the brightest stars in the field of view, using <code>HipparcosCatalogue</code></li>
</ul>
<h4 id="2-input-and-output-2"><a class="header" href="#2-input-and-output-2">2. input and output</a></h4>
<ul>
<li>input
<ul>
<li>(void)</li>
</ul>
</li>
<li>output
<ul>
<li>(void)</li>
</ul>
</li>
</ul>
<h4 id="3-main-process"><a class="header" href="#3-main-process">3. main process</a></h4>
<p>When <code>ObserveStars</code> is called in the <code>MainRoutine</code>, this function works as follows:</p>
<ol>
<li>Clear <code>star_in_sight</code></li>
<li>Judge the brightest star (provided by <code>HipparcosCatalogue</code>) is in the field of view</li>
<li>If the star is in the field of view, push the information (such as the HIP ID and its position on the image sensor) to <code>star_in_sight</code></li>
<li>Go to step 2. to judge the next brightest star</li>
<li>Exit the loop when the number of elements of <code>star_in_sight</code> reaches the specified number</li>
</ol>
<h4 id="4-error-handling"><a class="header" href="#4-error-handling">4. error handling</a></h4>
<p>If all the data in <code>HipparcosCatalogue</code> are checked before the number of elements of <code>star_in_sight</code> reaches the specified number, the data of lacking element is filled with -1.</p>
<h2 id="3-results-of-verifications"><a class="header" href="#3-results-of-verifications">3. Results of verifications</a></h2>
<p>In this section, the output of the functions when some angular velocity is input is verified.</p>
<h3 id="1-input-of-angular-velocity-around-x-axis-of-the-body-coordinate"><a class="header" href="#1-input-of-angular-velocity-around-x-axis-of-the-body-coordinate">1. Input of angular velocity around X-axis of the body coordinate</a></h3>
<h4 id="1-overview-3"><a class="header" href="#1-overview-3">1. overview</a></h4>
<ul>
<li>input $ω_b=[0.1~0~0]^T$ ． </li>
</ul>
<h4 id="2-conditions-for-the-verification"><a class="header" href="#2-conditions-for-the-verification">2. conditions for the verification</a></h4>
<ul>
<li>input files
<ul>
<li><code>sample_simulation_base.ini</code></li>
<li><code>telescope.ini</code></li>
</ul>
</li>
<li>initial condition
<ul>
<li><code>sample_simulation_base.ini</code>
<pre><code>Simulation start date[UTC] : 2017/12/01 11:00:00.0
Simulation finish time[sec] : 1500
Quaternion : q_i2b=[0 0 0 1]^T
</code></pre>
</li>
<li><code>telescope.ini</code>
<pre><code>q_b2c=[0 0 0 1]^T
sun_forbidden_angle = 60
earth_forbidden_angle = 60
moon_forbidden_angle = 60
x_num_of_pix = 2048
y_num_of_pix = 2048
x_fov_par_pix = 0.02
y_fov_par_pix = 0.02
</code></pre>
</li>
<li><code>sample_simulation_base.ini</code>
<pre><code>[HIPPARCOS_CATALOGUE]
max_magnitude = 5.0
calculation = ENABLE
logging = DISABLE
</code></pre>
</li>
</ul>
</li>
</ul>
<p>The disturbance torque in the main function of <code>sample_case.cpp</code> is commented out.</p>
<h4 id="3-result"><a class="header" href="#3-result">3. result</a></h4>
<ol>
<li>judge for forbidden angle
<ul>
<li>The angle from the line of sight about the direction of the Sun, the Earth, the Moon is as follows:</li>
</ul>
</li>
</ol>
<div align="center">
  <figure id="angle_celes1">
  <img src="./figs/angle_celes1.jpg" width=400 alt="The angle from the line of sight about the direction of the Sun, the Earth, the Moon">
  <figcaption>The angle from the line of sight about the direction of the Sun, the Earth, the Moon</figcaption>
  </figure>
  </div>
  Then, the result of the judge for the forbidden angles is as follows:
  <div align="center">
  <figure id="forbidden_angle1">
  <img src="./figs/forbidden_angle1.jpg" width=400 alt="result of the judge for the forbidden angles about the Sun, the Earth, the Moon">
  <figcaption>result of the judge for the forbidden angles about the Sun, the Earth, the Moon</figcaption>
  </figure>
  </div>
  The above figures show that the judge correctly detects when a celestial body in its forbidden angle.
<ol start="2">
<li><code>Observe</code> function
<ul>
<li>Only the Moon and the Earth are in the field of view (See the figure &quot;The angle from the line of sight about the direction of the Sun, the Earth, the Moon&quot;). The track of the image of the Moon on the image sensor is as follows: </li>
</ul>
</li>
</ol>
<div align="center">
  <figure id="track_moon1">
  <img src="./figs/track_moon1.jpg" width=400 alt="The track of the image of the Moon on the image sensor">
  <figcaption>The track of the image of the Moon on the image sensor</figcaption>
  </figure>
  </div>
  This figure shows the track makes a circle. This result seems to be reasonable, because the angular velocity around the X-axis of the body coordinate correspond with that of the component coordinate, for $q_{b2c}=[0~0~0~1]^T$ . The 3D plot of MOON_POS_B for further verification is as follows:
  <div align="center">
  <figure id="moon_pos_b1">
  <img src="./figs/moon_pos_b1.jpg" width=400 alt="3D plot of MOON_POS_B">
  <figcaption>3D plot of MOON_POS_B</figcaption>
  </figure>
  </div>
  Considering that the projection of the track of MOON_POS_B to the YZ plane corresponds the track of the image on the image sensor because the line of sight is the X-axis, the result also seems to be reasonable. Next, the track of the image of the Moon on the image sensor is as follows:
  <div align="center">
  <figure id="track_earth1">
  <img src="./figs/track_earth1.jpg" width=400 alt="The track of the image of the Earth on the image sensor">
  <figcaption>The track of the image of the Earth on the image sensor</figcaption>
  </figure>
  </div>
<p>In addition, the 3D plot of EARTH_POS_B is as follows:</p>
<div align="center">
  <figure id="earth_pos_b1">
  <img src="./figs/earth_pos_b1.jpg" width=400 alt="3D plot of EARTH_POS_B">
  <figcaption>3D plot of EARTH_POS_B</figcaption>
  </figure>
  </div>
  As well as the Moon case, this result seems to be reasonable because the projection of the track of the Earth to the YZ plane corresponds with the track of the image.
<ol start="3">
<li><code>ObserveStars</code>function</li>
</ol>
<ul>
<li>The first, second, and third HIP ID outputs were 113368, 9884, and 3419. Their track on the image sensor are as follows:</li>
</ul>
<div align="center">
  <figure id="observe_stars1">
  <img src="./figs/observe_stars1.jpg" width=400 alt="The stars' track on the image sensor">
  <figcaption>The stars' track on the image sensor</figcaption>
  </figure>
  </div>
<p>The tracks make circles, which are the reasonable outputs because of the same reason stated in the verification of <code>Observe</code> function. In addition, the each Vmag of HIP ID=113368，9884，and 3419 is 1.17，2.01，and 2.04, so it is verified that the outputs are in order of brightness.</p>
<h3 id="2-input-of-angular-velocity-around-y-axis-of-the-body-coordinate"><a class="header" href="#2-input-of-angular-velocity-around-y-axis-of-the-body-coordinate">2. input of angular velocity around y axis of the body coordinate</a></h3>
<h4 id="1-overview-4"><a class="header" href="#1-overview-4">1. overview</a></h4>
<ul>
<li>The angular velocity input is $ω_b=[0.1~0~0]^T$ ．The other condition is the same as the case of 1. Note that the verification of the case around z axis is omitted because y and z are equivalent under this condition.</li>
</ul>
<h4 id="2-result"><a class="header" href="#2-result">2. result</a></h4>
<ol>
<li>judge for forbidden angle</li>
</ol>
<ul>
<li>The angle from the line of sight about the direction of the Sun, the Earth, the Moon is as follows:</li>
</ul>
<div align="center">
<figure id="angle_celes2">
<img src="./figs/angle_celes2.jpg" width=400 alt="The angle from the line of sight about the direction of the Sun, the Earth, the Moon">
<figcaption>The angle from the line of sight about the direction of the Sun, the Earth, the Moon</figcaption>
</figure>
Then, the result of the judge for the forbidden angles is as follows:
<figure id="forbidden_angle2">
<img src="./figs/forbidden_angle2.jpg" width=400 alt="The result of the judge for the forbidden angles">
<figcaption>The result of the judge for the forbidden angles</figcaption>
</figure>
</div>
These above figures show that the judge is correctly conducted when a celestial body in its forbidden angle.
<ol start="2">
<li><code>Observe</code> function</li>
</ol>
<ul>
<li>The figure &quot;The angle from the line of sight about the direction of the Sun, the Earth, the Moon&quot; shows that the earth is mainly in the field of view, so this section discusses only about the Earth. The track of the image of the Earth is as follows (For the sake of ease, only 4 tracks in the field of view are displayed):</li>
</ul>
<div align="center">
<figure id="track_earth2">
<img src="./figs/track_earth2.jpg" width=400 alt="The track of the image of the Earth on the image sensor">
<figcaption>The track of the image of the Earth on the image sensor</figcaption>
</figure>
</div>
In addition, the 3D plot of EARTH_POS_B is as follows:
<div align="center">
<figure id="earth_pos_b2">
<img src="./figs/earth_pos_b2.jpg" width=400 alt="3D plot of EARTH_POS_B">
<figcaption>3D plot of EARTH_POS_B</figcaption>
</figure>
</div>
The 3D plot of EARTH_POS_B shows that the track of EARTH_POS_B is a spiral which axis is at right angle to the line of sight. In this case, it can be showed that the track on image sensor forms a hyperbola(The proof for this is omitted). Considering this fact, the result seems to be reasonable.
<ol start="3">
<li><code>ObserveStars</code> function</li>
</ol>
<ul>
<li>The tracks of the stars are partially as follows:</li>
</ul>
<div align="center">
<figure id="observe_stars2">
<img src="./figs/observe_stars2.jpg" width=400 alt="The stars' track on the image sensor">
<figcaption>The stars' track on the image sensor</figcaption>
</figure>
</div>
As mentioned in `Observe` function section, they form hyperbolas which axis of symmetry is Y=1024. In addition, it was confirmed that the data was output in order of the brightness on each time (The result is complicated, so it is not list in this manual).
<h2 id="4-references"><a class="header" href="#4-references">4. References</a></h2>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../Specifications/Component/AOCS/Spec_RWJitter.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../Specifications/Component/Power/Spec_PCU.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../Specifications/Component/AOCS/Spec_RWJitter.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../Specifications/Component/Power/Spec_PCU.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
